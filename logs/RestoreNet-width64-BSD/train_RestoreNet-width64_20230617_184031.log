2023-06-17 18:40:31,276 INFO: 
                ____                _       _____  ____
               / __ ) ____ _ _____ (_)_____/ ___/ / __ \
              / __  |/ __ `// ___// // ___/\__ \ / /_/ /
             / /_/ // /_/ /(__  )/ // /__ ___/ // _, _/
            /_____/ \__,_//____//_/ \___//____//_/ |_|
     ______                   __   __                 __      __
    / ____/____   ____   ____/ /  / /   __  __ _____ / /__   / /
   / / __ / __ \ / __ \ / __  /  / /   / / / // ___// //_/  / /
  / /_/ // /_/ // /_/ // /_/ /  / /___/ /_/ // /__ / /<    /_/
  \____/ \____/ \____/ \____/  /_____/\____/ \___//_/|_|  (_)
    
Version Information: 
	BasicSR: 1.2.0+50cb149
	PyTorch: 2.0.0
	TorchVision: 0.15.0
2023-06-17 18:40:31,278 INFO: 
  name: RestoreNet-width64
  model_type: ImageRestorationModel
  scale: 1
  num_gpu: 1
  manual_seed: 10
  datasets:[
    train:[
      name: RestoreNet-train
      type: PairedImageDataset
      dataroot_gt: D:\Premodel\RestoreNet\train\output
      dataroot_lq: D:\Premodel\RestoreNet\train\input
      filename_tmpl: {}
      io_backend:[
        type: disk
      ]
      gt_size: 256
      use_flip: True
      use_rot: True
      use_shuffle: True
      num_worker_per_gpu: 2
      batch_size_per_gpu: 2
      dataset_enlarge_ratio: 1
      prefetch_mode: None
      phase: train
      scale: 1
    ]
    val:[
      name: RestoreNet-test
      type: PairedImageDataset
      dataroot_gt: D:\Premodel\RestoreNet\test\output
      dataroot_lq: D:\Premodel\RestoreNet\test\input
      io_backend:[
        type: disk
      ]
      phase: val
      scale: 1
    ]
  ]
  network_g:[
    type: RestoreNetLocal
    width_deblur: 64
    enc_blk_nums_deblur: [1, 1, 1, 28]
    middle_blk_num_deblur: 1
    dec_blk_nums_deblur: [1, 1, 1, 1]
    dw_expand_deblur: 2
    ffn_expand_deblur: 2
    width_denoise: 64
    enc_blk_nums_denoise: [2, 2, 4, 8]
    middle_blk_num_denoise: 12
    dec_blk_nums_denoise: [2, 2, 2, 2]
    dw_expand_denoise: 2
    ffn_expand_denoise: 2
  ]
  path:[
    pretrain_network_g: None
    strict_load_g: True
    resume_state: experiments/RestoreNet-width64/training_states/375000.state
    root: d:\premodel\restorenet64
    experiments_root: d:\premodel\restorenet64\experiments\RestoreNet-width64
    models: d:\premodel\restorenet64\experiments\RestoreNet-width64\models
    training_states: d:\premodel\restorenet64\experiments\RestoreNet-width64\training_states
    log: d:\premodel\restorenet64\experiments\RestoreNet-width64
    visualization: d:\premodel\restorenet64\experiments\RestoreNet-width64\visualization
  ]
  train:[
    optim_g:[
      type: AdamW
      lr: 0.001
      weight_decay: 0.001
      betas: [0.9, 0.9]
    ]
    scheduler:[
      type: TrueCosineAnnealingLR
      T_max: 400000
      eta_min: 1e-07
    ]
    total_iter: 400000
    warmup_iter: -1
    pixel_opt:[
      type: PSNRLoss
      loss_weight: 1
      reduction: mean
    ]
  ]
  val:[
    val_freq: 5000.0
    save_img: False
    metrics:[
      psnr:[
        type: calculate_psnr
        crop_border: 0
        test_y_channel: False
      ]
      ssim:[
        type: calculate_ssim
        crop_border: 0
        test_y_channel: False
      ]
    ]
  ]
  logger:[
    print_freq: 200
    save_checkpoint_freq: 5000.0
    use_tb_logger: True
    wandb:[
      project: None
      resume_id: None
    ]
  ]
  dist_params:[
    backend: gloo
    port: 4321
  ]
  is_train: True
  dist: False
  rank: 0
  world_size: 1

2023-06-17 18:40:37,220 INFO: Dataset PairedImageDataset - RestoreNet-train is created.
2023-06-17 18:40:37,221 INFO: Training statistics:
	Number of train images: 19978
	Dataset enlarge ratio: 1
	Batch size per gpu: 2
	World size (gpu number): 1
	Require iter number per epoch: 9989
	Total epochs: 41; iters: 400000.
2023-06-17 18:40:37,223 INFO: Dataset PairedImageDataset - RestoreNet-test is created.
2023-06-17 18:40:37,224 INFO: Number of val images/folders in RestoreNet-test: 21
2023-06-17 18:40:37,224 INFO: Set pretrain_network_g to d:\premodel\restorenet64\experiments\RestoreNet-width64\models\net_g_375000.pth
2023-06-17 18:40:44,434 INFO: Loading RestoreNetLocal model from d:\premodel\restorenet64\experiments\RestoreNet-width64\models\net_g_375000.pth.
2023-06-17 18:40:47,198 INFO: Model [ImageRestorationModel] is created.
2023-06-17 18:40:47,760 INFO: Resuming training from epoch: 31, iter: 375000.
2023-06-17 18:40:51,864 INFO: Start training from epoch: 31, iter: 375000
2023-06-17 18:42:44,364 INFO: [Resto..][epoch: 31, iter: 375,200, lr:(9.555e-06,)] [eta: 3:59:46, time (data): 0.536 (0.001)] l_pix: -2.4965e+01 
2023-06-17 18:44:34,920 INFO: [Resto..][epoch: 31, iter: 375,400, lr:(9.403e-06,)] [eta: 3:52:14, time (data): 0.537 (0.001)] l_pix: -2.3589e+01 
2023-06-17 18:46:25,620 INFO: [Resto..][epoch: 31, iter: 375,600, lr:(9.253e-06,)] [eta: 3:48:36, time (data): 0.558 (0.001)] l_pix: -2.6161e+01 
2023-06-17 18:48:16,438 INFO: [Resto..][epoch: 31, iter: 375,800, lr:(9.104e-06,)] [eta: 3:45:54, time (data): 0.579 (0.001)] l_pix: -2.7540e+01 
2023-06-17 18:50:07,231 INFO: [Resto..][epoch: 31, iter: 376,000, lr:(8.956e-06,)] [eta: 3:43:33, time (data): 0.573 (0.001)] l_pix: -2.1771e+01 
2023-06-17 18:51:57,392 INFO: [Resto..][epoch: 31, iter: 376,200, lr:(8.810e-06,)] [eta: 3:41:09, time (data): 0.549 (0.001)] l_pix: -2.1755e+01 
2023-06-17 18:53:48,907 INFO: [Resto..][epoch: 31, iter: 376,400, lr:(8.664e-06,)] [eta: 3:39:17, time (data): 0.542 (0.001)] l_pix: -1.8783e+01 
2023-06-17 18:55:40,238 INFO: [Resto..][epoch: 31, iter: 376,600, lr:(8.520e-06,)] [eta: 3:37:23, time (data): 0.549 (0.001)] l_pix: -2.3362e+01 
2023-06-17 18:57:30,977 INFO: [Resto..][epoch: 31, iter: 376,800, lr:(8.377e-06,)] [eta: 3:35:22, time (data): 0.545 (0.001)] l_pix: -1.8991e+01 
2023-06-17 18:59:21,509 INFO: [Resto..][epoch: 31, iter: 377,000, lr:(8.236e-06,)] [eta: 3:33:21, time (data): 0.603 (0.000)] l_pix: -2.1991e+01 
2023-06-17 19:01:12,505 INFO: [Resto..][epoch: 31, iter: 377,200, lr:(8.095e-06,)] [eta: 3:31:26, time (data): 0.551 (0.000)] l_pix: -1.9915e+01 
2023-06-17 19:03:03,237 INFO: [Resto..][epoch: 31, iter: 377,400, lr:(7.956e-06,)] [eta: 3:29:29, time (data): 0.577 (0.000)] l_pix: -2.1393e+01 
2023-06-17 19:04:54,205 INFO: [Resto..][epoch: 31, iter: 377,600, lr:(7.818e-06,)] [eta: 3:27:36, time (data): 0.566 (0.001)] l_pix: -2.0767e+01 
2023-06-17 19:06:44,491 INFO: [Resto..][epoch: 31, iter: 377,800, lr:(7.681e-06,)] [eta: 3:25:37, time (data): 0.589 (0.000)] l_pix: -2.4076e+01 
2023-06-17 19:08:35,844 INFO: [Resto..][epoch: 31, iter: 378,000, lr:(7.545e-06,)] [eta: 3:23:47, time (data): 0.587 (0.001)] l_pix: -2.5228e+01 
2023-06-17 19:10:27,119 INFO: [Resto..][epoch: 31, iter: 378,200, lr:(7.411e-06,)] [eta: 3:21:57, time (data): 0.558 (0.001)] l_pix: -2.3329e+01 
2023-06-17 19:12:18,132 INFO: [Resto..][epoch: 31, iter: 378,400, lr:(7.278e-06,)] [eta: 3:20:05, time (data): 0.641 (0.001)] l_pix: -2.0014e+01 
2023-06-17 19:14:09,234 INFO: [Resto..][epoch: 31, iter: 378,600, lr:(7.146e-06,)] [eta: 3:18:13, time (data): 0.537 (0.001)] l_pix: -2.8639e+01 
2023-06-17 19:16:00,302 INFO: [Resto..][epoch: 31, iter: 378,800, lr:(7.015e-06,)] [eta: 3:16:22, time (data): 0.542 (0.001)] l_pix: -2.7710e+01 
2023-06-17 19:17:51,033 INFO: [Resto..][epoch: 31, iter: 379,000, lr:(6.885e-06,)] [eta: 3:14:28, time (data): 0.541 (0.000)] l_pix: -2.4670e+01 
2023-06-17 19:19:41,944 INFO: [Resto..][epoch: 31, iter: 379,200, lr:(6.757e-06,)] [eta: 3:12:36, time (data): 0.537 (0.000)] l_pix: -3.0105e+01 
2023-06-17 19:21:33,027 INFO: [Resto..][epoch: 31, iter: 379,400, lr:(6.630e-06,)] [eta: 3:10:45, time (data): 0.540 (0.001)] l_pix: -2.3182e+01 
2023-06-17 19:23:23,658 INFO: [Resto..][epoch: 31, iter: 379,600, lr:(6.504e-06,)] [eta: 3:08:51, time (data): 0.534 (0.000)] l_pix: -2.0822e+01 
2023-06-17 19:25:15,262 INFO: [Resto..][epoch: 31, iter: 379,800, lr:(6.379e-06,)] [eta: 3:07:02, time (data): 0.607 (0.000)] l_pix: -2.2480e+01 
2023-06-17 19:27:07,015 INFO: [Resto..][epoch: 31, iter: 380,000, lr:(6.256e-06,)] [eta: 3:05:14, time (data): 0.557 (0.001)] l_pix: -2.7769e+01 
2023-06-17 19:27:07,016 INFO: Saving models and training states.
2023-06-17 19:28:01,677 INFO: Validation RestoreNet-test, 		 # psnr: 25.0309	 # ssim: 0.8448
2023-06-17 19:28:01,679 INFO: [Resto..][epoch: 31, iter: 380,000, lr:(6.256e-06,)] m_psnr: 2.5031e+01 m_ssim: 8.4481e-01 
2023-06-17 19:29:54,001 INFO: [Resto..][epoch: 31, iter: 380,200, lr:(6.134e-06,)] [eta: 3:06:55, time (data): 0.556 (0.001)] l_pix: -2.4006e+01 
2023-06-17 19:31:47,234 INFO: [Resto..][epoch: 31, iter: 380,400, lr:(6.013e-06,)] [eta: 3:05:02, time (data): 0.564 (0.001)] l_pix: -2.1598e+01 
2023-06-17 19:33:39,954 INFO: [Resto..][epoch: 31, iter: 380,600, lr:(5.893e-06,)] [eta: 3:03:06, time (data): 0.559 (0.000)] l_pix: -2.2316e+01 
2023-06-17 19:35:32,659 INFO: [Resto..][epoch: 31, iter: 380,800, lr:(5.774e-06,)] [eta: 3:01:11, time (data): 0.540 (0.001)] l_pix: -2.8192e+01 
2023-06-17 19:37:25,908 INFO: [Resto..][epoch: 31, iter: 381,000, lr:(5.657e-06,)] [eta: 2:59:18, time (data): 0.540 (0.001)] l_pix: -2.6117e+01 
2023-06-17 19:39:19,395 INFO: [Resto..][epoch: 31, iter: 381,200, lr:(5.541e-06,)] [eta: 2:57:25, time (data): 0.594 (0.000)] l_pix: -2.3362e+01 
2023-06-17 19:41:11,943 INFO: [Resto..][epoch: 31, iter: 381,400, lr:(5.426e-06,)] [eta: 2:55:30, time (data): 0.572 (0.001)] l_pix: -2.1874e+01 
2023-06-17 19:43:03,856 INFO: [Resto..][epoch: 31, iter: 381,600, lr:(5.312e-06,)] [eta: 2:53:33, time (data): 0.553 (0.001)] l_pix: -2.9184e+01 
2023-06-17 19:44:55,863 INFO: [Resto..][epoch: 31, iter: 381,800, lr:(5.199e-06,)] [eta: 2:51:37, time (data): 0.560 (0.000)] l_pix: -2.1561e+01 
2023-06-17 19:46:47,994 INFO: [Resto..][epoch: 31, iter: 382,000, lr:(5.088e-06,)] [eta: 2:49:41, time (data): 0.562 (0.001)] l_pix: -2.3158e+01 
2023-06-17 19:48:39,909 INFO: [Resto..][epoch: 31, iter: 382,200, lr:(4.978e-06,)] [eta: 2:47:45, time (data): 0.574 (0.001)] l_pix: -1.8086e+01 
2023-06-17 19:50:31,821 INFO: [Resto..][epoch: 31, iter: 382,400, lr:(4.869e-06,)] [eta: 2:45:49, time (data): 0.550 (0.000)] l_pix: -2.4096e+01 
2023-06-17 19:52:22,807 INFO: [Resto..][epoch: 31, iter: 382,600, lr:(4.762e-06,)] [eta: 2:43:51, time (data): 0.560 (0.001)] l_pix: -2.3476e+01 
2023-06-17 19:54:14,321 INFO: [Resto..][epoch: 31, iter: 382,800, lr:(4.655e-06,)] [eta: 2:41:55, time (data): 0.562 (0.001)] l_pix: -2.3161e+01 
2023-06-17 19:56:05,873 INFO: [Resto..][epoch: 31, iter: 383,000, lr:(4.550e-06,)] [eta: 2:39:59, time (data): 0.541 (0.001)] l_pix: -2.6775e+01 
2023-06-17 19:57:57,844 INFO: [Resto..][epoch: 31, iter: 383,200, lr:(4.446e-06,)] [eta: 2:38:04, time (data): 0.578 (0.000)] l_pix: -2.4860e+01 
2023-06-17 19:59:49,984 INFO: [Resto..][epoch: 31, iter: 383,400, lr:(4.344e-06,)] [eta: 2:36:09, time (data): 0.568 (0.001)] l_pix: -3.0066e+01 
2023-06-17 20:01:41,731 INFO: [Resto..][epoch: 31, iter: 383,600, lr:(4.242e-06,)] [eta: 2:34:14, time (data): 0.580 (0.000)] l_pix: -2.6564e+01 
2023-06-17 20:03:33,473 INFO: [Resto..][epoch: 31, iter: 383,800, lr:(4.142e-06,)] [eta: 2:32:19, time (data): 0.538 (0.001)] l_pix: -2.2620e+01 
2023-06-17 20:05:26,566 INFO: [Resto..][epoch: 31, iter: 384,000, lr:(4.043e-06,)] [eta: 2:30:27, time (data): 0.541 (0.001)] l_pix: -2.4308e+01 
2023-06-17 20:07:19,187 INFO: [Resto..][epoch: 31, iter: 384,200, lr:(3.945e-06,)] [eta: 2:28:34, time (data): 0.575 (0.001)] l_pix: -2.0516e+01 
2023-06-17 20:09:12,564 INFO: [Resto..][epoch: 31, iter: 384,400, lr:(3.848e-06,)] [eta: 2:26:42, time (data): 0.561 (0.000)] l_pix: -2.9352e+01 
2023-06-17 20:11:05,102 INFO: [Resto..][epoch: 31, iter: 384,600, lr:(3.753e-06,)] [eta: 2:24:48, time (data): 0.555 (0.000)] l_pix: -2.3344e+01 
2023-06-17 20:12:58,000 INFO: [Resto..][epoch: 31, iter: 384,800, lr:(3.659e-06,)] [eta: 2:22:56, time (data): 0.575 (0.001)] l_pix: -2.5032e+01 
2023-06-17 20:14:51,216 INFO: [Resto..][epoch: 32, iter: 385,000, lr:(3.566e-06,)] [eta: 2:21:03, time (data): 0.566 (0.001)] l_pix: -2.6005e+01 
2023-06-17 20:14:51,216 INFO: Saving models and training states.
2023-06-17 20:15:05,487 INFO: Validation RestoreNet-test, 		 # psnr: 25.0284	 # ssim: 0.8447
2023-06-17 20:15:05,489 INFO: [Resto..][epoch: 32, iter: 385,000, lr:(3.566e-06,)] m_psnr: 2.5028e+01 m_ssim: 8.4474e-01 
2023-06-17 20:16:54,245 INFO: [Resto..][epoch: 32, iter: 385,200, lr:(3.474e-06,)] [eta: 2:19:25, time (data): 0.553 (0.001)] l_pix: -2.1834e+01 
2023-06-17 20:18:42,667 INFO: [Resto..][epoch: 32, iter: 385,400, lr:(3.384e-06,)] [eta: 2:17:26, time (data): 0.544 (0.000)] l_pix: -2.4694e+01 
2023-06-17 20:20:31,362 INFO: [Resto..][epoch: 32, iter: 385,600, lr:(3.294e-06,)] [eta: 2:15:27, time (data): 0.543 (0.001)] l_pix: -2.4978e+01 
2023-06-17 20:22:19,941 INFO: [Resto..][epoch: 32, iter: 385,800, lr:(3.206e-06,)] [eta: 2:13:28, time (data): 0.538 (0.000)] l_pix: -2.8533e+01 
2023-06-17 20:24:08,832 INFO: [Resto..][epoch: 32, iter: 386,000, lr:(3.120e-06,)] [eta: 2:11:30, time (data): 0.545 (0.000)] l_pix: -2.6588e+01 
2023-06-17 20:25:57,431 INFO: [Resto..][epoch: 32, iter: 386,200, lr:(3.034e-06,)] [eta: 2:09:33, time (data): 0.543 (0.001)] l_pix: -2.8879e+01 
2023-06-17 20:27:46,355 INFO: [Resto..][epoch: 32, iter: 386,400, lr:(2.950e-06,)] [eta: 2:07:36, time (data): 0.551 (0.001)] l_pix: -2.3450e+01 
2023-06-17 20:29:35,120 INFO: [Resto..][epoch: 32, iter: 386,600, lr:(2.867e-06,)] [eta: 2:05:39, time (data): 0.539 (0.000)] l_pix: -2.6066e+01 
2023-06-17 20:31:23,087 INFO: [Resto..][epoch: 32, iter: 386,800, lr:(2.785e-06,)] [eta: 2:03:41, time (data): 0.539 (0.001)] l_pix: -2.2346e+01 
2023-06-17 20:33:11,186 INFO: [Resto..][epoch: 32, iter: 387,000, lr:(2.704e-06,)] [eta: 2:01:44, time (data): 0.540 (0.001)] l_pix: -2.1474e+01 
2023-06-17 20:34:59,677 INFO: [Resto..][epoch: 32, iter: 387,200, lr:(2.625e-06,)] [eta: 1:59:47, time (data): 0.541 (0.001)] l_pix: -2.4274e+01 
2023-06-17 20:36:48,546 INFO: [Resto..][epoch: 32, iter: 387,400, lr:(2.546e-06,)] [eta: 1:57:51, time (data): 0.543 (0.001)] l_pix: -2.0793e+01 
2023-06-17 20:38:36,754 INFO: [Resto..][epoch: 32, iter: 387,600, lr:(2.469e-06,)] [eta: 1:55:55, time (data): 0.540 (0.001)] l_pix: -2.2527e+01 
2023-06-17 20:40:24,597 INFO: [Resto..][epoch: 32, iter: 387,800, lr:(2.394e-06,)] [eta: 1:53:59, time (data): 0.540 (0.000)] l_pix: -2.3043e+01 
2023-06-17 20:42:12,485 INFO: [Resto..][epoch: 32, iter: 388,000, lr:(2.319e-06,)] [eta: 1:52:03, time (data): 0.542 (0.000)] l_pix: -2.5717e+01 
2023-06-17 20:44:00,471 INFO: [Resto..][epoch: 32, iter: 388,200, lr:(2.246e-06,)] [eta: 1:50:07, time (data): 0.538 (0.000)] l_pix: -2.1437e+01 
2023-06-17 20:45:48,324 INFO: [Resto..][epoch: 32, iter: 388,400, lr:(2.174e-06,)] [eta: 1:48:11, time (data): 0.542 (0.000)] l_pix: -2.7189e+01 
2023-06-17 20:47:36,249 INFO: [Resto..][epoch: 32, iter: 388,600, lr:(2.103e-06,)] [eta: 1:46:16, time (data): 0.537 (0.001)] l_pix: -2.2993e+01 
2023-06-17 20:49:23,807 INFO: [Resto..][epoch: 32, iter: 388,800, lr:(2.033e-06,)] [eta: 1:44:21, time (data): 0.532 (0.001)] l_pix: -2.3333e+01 

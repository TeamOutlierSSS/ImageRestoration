2023-06-18 14:45:53,218 INFO: 
                ____                _       _____  ____
               / __ ) ____ _ _____ (_)_____/ ___/ / __ \
              / __  |/ __ `// ___// // ___/\__ \ / /_/ /
             / /_/ // /_/ /(__  )/ // /__ ___/ // _, _/
            /_____/ \__,_//____//_/ \___//____//_/ |_|
     ______                   __   __                 __      __
    / ____/____   ____   ____/ /  / /   __  __ _____ / /__   / /
   / / __ / __ \ / __ \ / __  /  / /   / / / // ___// //_/  / /
  / /_/ // /_/ // /_/ // /_/ /  / /___/ /_/ // /__ / /<    /_/
  \____/ \____/ \____/ \____/  /_____/\____/ \___//_/|_|  (_)
    
Version Information: 
	BasicSR: 1.2.0+50cb149
	PyTorch: 2.0.0
	TorchVision: 0.15.0
2023-06-18 14:45:53,219 INFO: 
  name: RestoreNet-width64
  model_type: ImageRestorationModel
  scale: 1
  num_gpu: 1
  manual_seed: 10
  datasets:[
    train:[
      name: RestoreNet-train
      type: PairedImageDataset
      dataroot_gt: D:\Premodel\RestoreNet\train\output
      dataroot_lq: D:\Premodel\RestoreNet\train\input
      filename_tmpl: {}
      io_backend:[
        type: disk
      ]
      gt_size: 256
      use_flip: True
      use_rot: True
      use_shuffle: True
      num_worker_per_gpu: 2
      batch_size_per_gpu: 2
      dataset_enlarge_ratio: 1
      prefetch_mode: None
      phase: train
      scale: 1
    ]
    val:[
      name: RestoreNet-test
      type: PairedImageDataset
      dataroot_gt: D:\Premodel\RestoreNet\test\output
      dataroot_lq: D:\Premodel\RestoreNet\test\input
      io_backend:[
        type: disk
      ]
      phase: val
      scale: 1
    ]
  ]
  network_g:[
    type: RestoreNetLocal
    width_deblur: 64
    enc_blk_nums_deblur: [1, 1, 1, 28]
    middle_blk_num_deblur: 1
    dec_blk_nums_deblur: [1, 1, 1, 1]
    dw_expand_deblur: 2
    ffn_expand_deblur: 2
    width_denoise: 64
    enc_blk_nums_denoise: [2, 2, 4, 8]
    middle_blk_num_denoise: 12
    dec_blk_nums_denoise: [2, 2, 2, 2]
    dw_expand_denoise: 2
    ffn_expand_denoise: 2
  ]
  path:[
    pretrain_network_g: None
    strict_load_g: True
    resume_state: experiments/RestoreNet-width64/training_states/385000.state
    root: d:\premodel\restorenet64
    experiments_root: d:\premodel\restorenet64\experiments\RestoreNet-width64
    models: d:\premodel\restorenet64\experiments\RestoreNet-width64\models
    training_states: d:\premodel\restorenet64\experiments\RestoreNet-width64\training_states
    log: d:\premodel\restorenet64\experiments\RestoreNet-width64
    visualization: d:\premodel\restorenet64\experiments\RestoreNet-width64\visualization
  ]
  train:[
    optim_g:[
      type: AdamW
      lr: 0.001
      weight_decay: 0.001
      betas: [0.9, 0.9]
    ]
    scheduler:[
      type: TrueCosineAnnealingLR
      T_max: 400000
      eta_min: 1e-07
    ]
    total_iter: 400000
    warmup_iter: -1
    pixel_opt:[
      type: PSNRLoss
      loss_weight: 1
      reduction: mean
    ]
  ]
  val:[
    val_freq: 5000.0
    save_img: False
    metrics:[
      psnr:[
        type: calculate_psnr
        crop_border: 0
        test_y_channel: False
      ]
      ssim:[
        type: calculate_ssim
        crop_border: 0
        test_y_channel: False
      ]
    ]
  ]
  logger:[
    print_freq: 200
    save_checkpoint_freq: 5000.0
    use_tb_logger: True
    wandb:[
      project: None
      resume_id: None
    ]
  ]
  dist_params:[
    backend: gloo
    port: 4321
  ]
  is_train: True
  dist: False
  rank: 0
  world_size: 1

2023-06-18 14:46:02,266 INFO: Dataset PairedImageDataset - RestoreNet-train is created.
2023-06-18 14:46:02,266 INFO: Training statistics:
	Number of train images: 19978
	Dataset enlarge ratio: 1
	Batch size per gpu: 2
	World size (gpu number): 1
	Require iter number per epoch: 9989
	Total epochs: 41; iters: 400000.
2023-06-18 14:46:02,270 INFO: Dataset PairedImageDataset - RestoreNet-test is created.
2023-06-18 14:46:02,270 INFO: Number of val images/folders in RestoreNet-test: 21
2023-06-18 14:46:02,270 INFO: Set pretrain_network_g to d:\premodel\restorenet64\experiments\RestoreNet-width64\models\net_g_385000.pth
2023-06-18 14:46:08,908 INFO: Loading RestoreNetLocal model from d:\premodel\restorenet64\experiments\RestoreNet-width64\models\net_g_385000.pth.
2023-06-18 14:46:11,961 INFO: Model [ImageRestorationModel] is created.
2023-06-18 14:46:13,581 INFO: Resuming training from epoch: 32, iter: 385000.
2023-06-18 14:46:17,772 INFO: Start training from epoch: 32, iter: 385000
2023-06-18 14:48:11,571 INFO: [Resto..][epoch: 32, iter: 385,200, lr:(3.474e-06,)] [eta: 2:24:47, time (data): 0.530 (0.000)] l_pix: -2.2221e+01 
2023-06-18 14:50:01,474 INFO: [Resto..][epoch: 32, iter: 385,400, lr:(3.384e-06,)] [eta: 2:18:16, time (data): 0.541 (0.000)] l_pix: -2.9202e+01 
2023-06-18 14:51:51,804 INFO: [Resto..][epoch: 32, iter: 385,600, lr:(3.294e-06,)] [eta: 2:15:03, time (data): 0.542 (0.000)] l_pix: -2.6446e+01 
2023-06-18 14:53:42,077 INFO: [Resto..][epoch: 32, iter: 385,800, lr:(3.206e-06,)] [eta: 2:12:30, time (data): 0.531 (0.000)] l_pix: -2.4649e+01 
2023-06-18 14:55:32,603 INFO: [Resto..][epoch: 32, iter: 386,000, lr:(3.120e-06,)] [eta: 2:10:17, time (data): 0.598 (0.000)] l_pix: -2.6649e+01 
2023-06-18 14:57:23,852 INFO: [Resto..][epoch: 32, iter: 386,200, lr:(3.034e-06,)] [eta: 2:08:21, time (data): 0.541 (0.000)] l_pix: -2.2988e+01 
2023-06-18 14:59:14,558 INFO: [Resto..][epoch: 32, iter: 386,400, lr:(2.950e-06,)] [eta: 2:06:20, time (data): 0.560 (0.000)] l_pix: -2.2975e+01 
2023-06-18 15:01:05,117 INFO: [Resto..][epoch: 32, iter: 386,600, lr:(2.867e-06,)] [eta: 2:04:21, time (data): 0.541 (0.000)] l_pix: -2.3297e+01 
2023-06-18 15:02:55,737 INFO: [Resto..][epoch: 32, iter: 386,800, lr:(2.785e-06,)] [eta: 2:02:24, time (data): 0.562 (0.000)] l_pix: -1.9705e+01 
2023-06-18 15:04:46,118 INFO: [Resto..][epoch: 32, iter: 387,000, lr:(2.704e-06,)] [eta: 2:00:27, time (data): 0.582 (0.000)] l_pix: -2.2610e+01 
2023-06-18 15:06:36,788 INFO: [Resto..][epoch: 32, iter: 387,200, lr:(2.625e-06,)] [eta: 1:58:33, time (data): 0.540 (0.000)] l_pix: -2.4677e+01 
2023-06-18 15:08:26,991 INFO: [Resto..][epoch: 32, iter: 387,400, lr:(2.546e-06,)] [eta: 1:56:36, time (data): 0.557 (0.000)] l_pix: -2.3704e+01 
2023-06-18 15:10:17,412 INFO: [Resto..][epoch: 32, iter: 387,600, lr:(2.469e-06,)] [eta: 1:54:42, time (data): 0.561 (0.000)] l_pix: -2.5064e+01 
2023-06-18 15:12:08,012 INFO: [Resto..][epoch: 32, iter: 387,800, lr:(2.394e-06,)] [eta: 1:52:49, time (data): 0.562 (0.000)] l_pix: -2.4302e+01 
2023-06-18 15:13:58,907 INFO: [Resto..][epoch: 32, iter: 388,000, lr:(2.319e-06,)] [eta: 1:50:58, time (data): 0.544 (0.000)] l_pix: -2.3004e+01 
2023-06-18 15:15:49,616 INFO: [Resto..][epoch: 32, iter: 388,200, lr:(2.246e-06,)] [eta: 1:49:06, time (data): 0.541 (0.000)] l_pix: -2.5729e+01 
2023-06-18 15:17:40,321 INFO: [Resto..][epoch: 32, iter: 388,400, lr:(2.174e-06,)] [eta: 1:47:14, time (data): 0.540 (0.000)] l_pix: -2.6914e+01 
2023-06-18 15:19:31,323 INFO: [Resto..][epoch: 32, iter: 388,600, lr:(2.103e-06,)] [eta: 1:45:23, time (data): 0.541 (0.000)] l_pix: -2.9657e+01 
2023-06-18 15:21:22,251 INFO: [Resto..][epoch: 32, iter: 388,800, lr:(2.033e-06,)] [eta: 1:43:32, time (data): 0.531 (0.000)] l_pix: -2.3459e+01 
2023-06-18 15:23:13,295 INFO: [Resto..][epoch: 32, iter: 389,000, lr:(1.965e-06,)] [eta: 1:41:42, time (data): 0.541 (0.000)] l_pix: -2.6254e+01 
2023-06-18 15:25:04,193 INFO: [Resto..][epoch: 32, iter: 389,200, lr:(1.898e-06,)] [eta: 1:39:51, time (data): 0.540 (0.000)] l_pix: -2.0811e+01 
2023-06-18 15:26:55,014 INFO: [Resto..][epoch: 32, iter: 389,400, lr:(1.832e-06,)] [eta: 1:37:59, time (data): 0.552 (0.000)] l_pix: -2.4829e+01 
2023-06-18 15:28:45,694 INFO: [Resto..][epoch: 32, iter: 389,600, lr:(1.767e-06,)] [eta: 1:36:08, time (data): 0.551 (0.000)] l_pix: -2.3926e+01 
2023-06-18 15:30:36,189 INFO: [Resto..][epoch: 32, iter: 389,800, lr:(1.704e-06,)] [eta: 1:34:16, time (data): 0.557 (0.000)] l_pix: -2.1856e+01 
2023-06-18 15:32:26,931 INFO: [Resto..][epoch: 32, iter: 390,000, lr:(1.641e-06,)] [eta: 1:32:25, time (data): 0.562 (0.000)] l_pix: -2.1408e+01 
2023-06-18 15:32:26,931 INFO: Saving models and training states.
2023-06-18 15:33:20,782 INFO: Validation RestoreNet-test, 		 # psnr: 25.0254	 # ssim: 0.8448
2023-06-18 15:33:20,789 INFO: [Resto..][epoch: 32, iter: 390,000, lr:(1.641e-06,)] m_psnr: 2.5025e+01 m_ssim: 8.4479e-01 
2023-06-18 15:35:08,920 INFO: [Resto..][epoch: 32, iter: 390,200, lr:(1.580e-06,)] [eta: 1:32:10, time (data): 0.542 (0.000)] l_pix: -2.7045e+01 
2023-06-18 15:36:57,084 INFO: [Resto..][epoch: 32, iter: 390,400, lr:(1.521e-06,)] [eta: 1:30:09, time (data): 0.540 (0.010)] l_pix: -1.8663e+01 
2023-06-18 15:38:45,056 INFO: [Resto..][epoch: 32, iter: 390,600, lr:(1.462e-06,)] [eta: 1:28:08, time (data): 0.541 (0.000)] l_pix: -2.3851e+01 
2023-06-18 15:40:33,144 INFO: [Resto..][epoch: 32, iter: 390,800, lr:(1.405e-06,)] [eta: 1:26:08, time (data): 0.541 (0.000)] l_pix: -2.2852e+01 
2023-06-18 15:42:21,248 INFO: [Resto..][epoch: 32, iter: 391,000, lr:(1.349e-06,)] [eta: 1:24:10, time (data): 0.541 (0.000)] l_pix: -2.4723e+01 
2023-06-18 15:44:09,399 INFO: [Resto..][epoch: 32, iter: 391,200, lr:(1.294e-06,)] [eta: 1:22:12, time (data): 0.542 (0.000)] l_pix: -2.2212e+01 
2023-06-18 15:45:57,909 INFO: [Resto..][epoch: 32, iter: 391,400, lr:(1.240e-06,)] [eta: 1:20:15, time (data): 0.550 (0.000)] l_pix: -2.8115e+01 
2023-06-18 15:47:46,113 INFO: [Resto..][epoch: 32, iter: 391,600, lr:(1.188e-06,)] [eta: 1:18:18, time (data): 0.541 (0.000)] l_pix: -2.1758e+01 
2023-06-18 15:49:34,220 INFO: [Resto..][epoch: 32, iter: 391,800, lr:(1.137e-06,)] [eta: 1:16:21, time (data): 0.538 (0.000)] l_pix: -2.1897e+01 
2023-06-18 15:51:22,843 INFO: [Resto..][epoch: 32, iter: 392,000, lr:(1.087e-06,)] [eta: 1:14:26, time (data): 0.540 (0.000)] l_pix: -2.3569e+01 
2023-06-18 15:53:10,989 INFO: [Resto..][epoch: 32, iter: 392,200, lr:(1.038e-06,)] [eta: 1:12:31, time (data): 0.541 (0.000)] l_pix: -2.4238e+01 
2023-06-18 15:54:59,153 INFO: [Resto..][epoch: 32, iter: 392,400, lr:(9.906e-07,)] [eta: 1:10:35, time (data): 0.541 (0.000)] l_pix: -2.5142e+01 
2023-06-18 15:56:47,288 INFO: [Resto..][epoch: 32, iter: 392,600, lr:(9.444e-07,)] [eta: 1:08:41, time (data): 0.551 (0.000)] l_pix: -2.0363e+01 
2023-06-18 15:58:35,526 INFO: [Resto..][epoch: 32, iter: 392,800, lr:(8.994e-07,)] [eta: 1:06:46, time (data): 0.540 (0.000)] l_pix: -2.2218e+01 
2023-06-18 16:00:23,701 INFO: [Resto..][epoch: 32, iter: 393,000, lr:(8.556e-07,)] [eta: 1:04:52, time (data): 0.542 (0.000)] l_pix: -2.6329e+01 
2023-06-18 16:02:11,802 INFO: [Resto..][epoch: 32, iter: 393,200, lr:(8.130e-07,)] [eta: 1:02:58, time (data): 0.542 (0.000)] l_pix: -2.3600e+01 
2023-06-18 16:03:59,885 INFO: [Resto..][epoch: 32, iter: 393,400, lr:(7.717e-07,)] [eta: 1:01:05, time (data): 0.537 (0.000)] l_pix: -2.3823e+01 
2023-06-18 16:05:48,184 INFO: [Resto..][epoch: 32, iter: 393,600, lr:(7.317e-07,)] [eta: 0:59:12, time (data): 0.541 (0.000)] l_pix: -2.6035e+01 
2023-06-18 16:07:36,370 INFO: [Resto..][epoch: 32, iter: 393,800, lr:(6.928e-07,)] [eta: 0:57:19, time (data): 0.540 (0.000)] l_pix: -2.1754e+01 
2023-06-18 16:09:24,432 INFO: [Resto..][epoch: 32, iter: 394,000, lr:(6.552e-07,)] [eta: 0:55:26, time (data): 0.531 (0.000)] l_pix: -2.3806e+01 
2023-06-18 16:11:12,531 INFO: [Resto..][epoch: 32, iter: 394,200, lr:(6.188e-07,)] [eta: 0:53:33, time (data): 0.542 (0.000)] l_pix: -2.2148e+01 
2023-06-18 16:13:00,839 INFO: [Resto..][epoch: 32, iter: 394,400, lr:(5.837e-07,)] [eta: 0:51:41, time (data): 0.542 (0.000)] l_pix: -2.5253e+01 
2023-06-18 16:14:48,959 INFO: [Resto..][epoch: 32, iter: 394,600, lr:(5.497e-07,)] [eta: 0:49:49, time (data): 0.541 (0.000)] l_pix: -2.2769e+01 
2023-06-18 16:16:37,189 INFO: [Resto..][epoch: 32, iter: 394,800, lr:(5.171e-07,)] [eta: 0:47:56, time (data): 0.540 (0.000)] l_pix: -2.6362e+01 
2023-06-18 16:18:25,369 INFO: [Resto..][epoch: 33, iter: 395,000, lr:(4.856e-07,)] [eta: 0:46:05, time (data): 0.542 (0.000)] l_pix: -2.3674e+01 
2023-06-18 16:18:25,369 INFO: Saving models and training states.
2023-06-18 16:18:38,713 INFO: Validation RestoreNet-test, 		 # psnr: 25.0210	 # ssim: 0.8447
2023-06-18 16:18:38,721 INFO: [Resto..][epoch: 33, iter: 395,000, lr:(4.856e-07,)] m_psnr: 2.5021e+01 m_ssim: 8.4473e-01 
2023-06-18 16:20:26,719 INFO: [Resto..][epoch: 33, iter: 395,200, lr:(4.554e-07,)] [eta: 0:44:19, time (data): 0.543 (0.000)] l_pix: -2.0408e+01 
2023-06-18 16:22:14,749 INFO: [Resto..][epoch: 33, iter: 395,400, lr:(4.264e-07,)] [eta: 0:42:27, time (data): 0.548 (0.000)] l_pix: -2.6879e+01 
2023-06-18 16:24:02,720 INFO: [Resto..][epoch: 33, iter: 395,600, lr:(3.986e-07,)] [eta: 0:40:35, time (data): 0.542 (0.000)] l_pix: -2.6268e+01 
2023-06-18 16:25:51,143 INFO: [Resto..][epoch: 33, iter: 395,800, lr:(3.721e-07,)] [eta: 0:38:43, time (data): 0.540 (0.000)] l_pix: -2.3974e+01 
2023-06-18 16:27:39,507 INFO: [Resto..][epoch: 33, iter: 396,000, lr:(3.468e-07,)] [eta: 0:36:52, time (data): 0.530 (0.000)] l_pix: -2.6033e+01 
2023-06-18 16:29:27,912 INFO: [Resto..][epoch: 33, iter: 396,200, lr:(3.228e-07,)] [eta: 0:35:00, time (data): 0.550 (0.010)] l_pix: -2.2531e+01 
2023-06-18 16:31:16,984 INFO: [Resto..][epoch: 33, iter: 396,400, lr:(2.999e-07,)] [eta: 0:33:09, time (data): 0.540 (0.000)] l_pix: -2.4510e+01 
2023-06-18 16:33:06,395 INFO: [Resto..][epoch: 33, iter: 396,600, lr:(2.783e-07,)] [eta: 0:31:18, time (data): 0.542 (0.000)] l_pix: -2.2092e+01 
2023-06-18 16:34:54,768 INFO: [Resto..][epoch: 33, iter: 396,800, lr:(2.580e-07,)] [eta: 0:29:27, time (data): 0.550 (0.000)] l_pix: -2.7349e+01 
2023-06-18 16:36:43,294 INFO: [Resto..][epoch: 33, iter: 397,000, lr:(2.389e-07,)] [eta: 0:27:36, time (data): 0.543 (0.010)] l_pix: -2.4274e+01 
2023-06-18 16:38:31,655 INFO: [Resto..][epoch: 33, iter: 397,200, lr:(2.210e-07,)] [eta: 0:25:45, time (data): 0.540 (0.000)] l_pix: -2.4014e+01 
2023-06-18 16:40:20,450 INFO: [Resto..][epoch: 33, iter: 397,400, lr:(2.043e-07,)] [eta: 0:23:54, time (data): 0.540 (0.000)] l_pix: -2.3979e+01 
2023-06-18 16:42:09,136 INFO: [Resto..][epoch: 33, iter: 397,600, lr:(1.889e-07,)] [eta: 0:22:04, time (data): 0.540 (0.000)] l_pix: -2.4281e+01 
2023-06-18 16:43:57,484 INFO: [Resto..][epoch: 33, iter: 397,800, lr:(1.747e-07,)] [eta: 0:20:13, time (data): 0.543 (0.000)] l_pix: -2.5185e+01 
2023-06-18 16:45:45,744 INFO: [Resto..][epoch: 33, iter: 398,000, lr:(1.617e-07,)] [eta: 0:18:22, time (data): 0.541 (0.000)] l_pix: -2.0658e+01 
2023-06-18 16:47:34,268 INFO: [Resto..][epoch: 33, iter: 398,200, lr:(1.500e-07,)] [eta: 0:16:32, time (data): 0.541 (0.000)] l_pix: -2.0666e+01 
2023-06-18 16:49:22,460 INFO: [Resto..][epoch: 33, iter: 398,400, lr:(1.395e-07,)] [eta: 0:14:41, time (data): 0.536 (0.000)] l_pix: -2.0532e+01 
2023-06-18 16:51:11,275 INFO: [Resto..][epoch: 33, iter: 398,600, lr:(1.303e-07,)] [eta: 0:12:51, time (data): 0.540 (0.000)] l_pix: -2.0901e+01 
2023-06-18 16:52:59,542 INFO: [Resto..][epoch: 33, iter: 398,800, lr:(1.222e-07,)] [eta: 0:11:00, time (data): 0.540 (0.000)] l_pix: -2.6160e+01 
2023-06-18 16:54:47,955 INFO: [Resto..][epoch: 33, iter: 399,000, lr:(1.155e-07,)] [eta: 0:09:10, time (data): 0.541 (0.000)] l_pix: -2.4835e+01 
2023-06-18 16:56:36,199 INFO: [Resto..][epoch: 33, iter: 399,200, lr:(1.099e-07,)] [eta: 0:07:20, time (data): 0.541 (0.000)] l_pix: -2.6660e+01 
2023-06-18 16:58:24,412 INFO: [Resto..][epoch: 33, iter: 399,400, lr:(1.056e-07,)] [eta: 0:05:29, time (data): 0.551 (0.000)] l_pix: -2.5552e+01 
2023-06-18 17:00:12,758 INFO: [Resto..][epoch: 33, iter: 399,600, lr:(1.025e-07,)] [eta: 0:03:39, time (data): 0.540 (0.000)] l_pix: -2.5500e+01 
2023-06-18 17:02:01,253 INFO: [Resto..][epoch: 33, iter: 399,800, lr:(1.006e-07,)] [eta: 0:01:49, time (data): 0.541 (0.000)] l_pix: -2.4759e+01 
2023-06-18 17:03:49,521 INFO: [Resto..][epoch: 33, iter: 400,000, lr:(1.000e-07,)] [eta: 0:00:00, time (data): 0.541 (0.000)] l_pix: -2.0897e+01 
2023-06-18 17:03:49,521 INFO: Saving models and training states.
2023-06-18 17:04:03,177 INFO: Validation RestoreNet-test, 		 # psnr: 25.0198	 # ssim: 0.8446
2023-06-18 17:04:03,177 INFO: [Resto..][epoch: 33, iter: 400,000, lr:(1.000e-07,)] m_psnr: 2.5020e+01 m_ssim: 8.4465e-01 
2023-06-18 17:04:03,184 INFO: End of training. Time consumed: 2:17:45
2023-06-18 17:04:03,184 INFO: Save the latest model.
2023-06-18 17:04:17,124 INFO: Validation RestoreNet-test, 		 # psnr: 25.0198	 # ssim: 0.8446

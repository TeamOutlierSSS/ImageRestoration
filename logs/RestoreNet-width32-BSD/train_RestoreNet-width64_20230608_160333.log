2023-06-08 16:03:33,829 INFO: 
                ____                _       _____  ____
               / __ ) ____ _ _____ (_)_____/ ___/ / __ \
              / __  |/ __ `// ___// // ___/\__ \ / /_/ /
             / /_/ // /_/ /(__  )/ // /__ ___/ // _, _/
            /_____/ \__,_//____//_/ \___//____//_/ |_|
     ______                   __   __                 __      __
    / ____/____   ____   ____/ /  / /   __  __ _____ / /__   / /
   / / __ / __ \ / __ \ / __  /  / /   / / / // ___// //_/  / /
  / /_/ // /_/ // /_/ // /_/ /  / /___/ /_/ // /__ / /<    /_/
  \____/ \____/ \____/ \____/  /_____/\____/ \___//_/|_|  (_)
    
Version Information: 
	BasicSR: 1.2.0+50cb149
	PyTorch: 2.0.0
	TorchVision: 0.15.0
2023-06-08 16:03:33,834 INFO: 
  name: RestoreNet-width64
  model_type: ImageRestorationModel
  scale: 1
  num_gpu: 1
  manual_seed: 10
  datasets:[
    train:[
      name: RestoreNet-train
      type: PairedImageDataset
      dataroot_gt: D:\Premodel\RestoreNet\train\output
      dataroot_lq: D:\Premodel\RestoreNet\train\input
      filename_tmpl: {}
      io_backend:[
        type: disk
      ]
      gt_size: 256
      use_flip: True
      use_rot: True
      use_shuffle: True
      num_worker_per_gpu: 2
      batch_size_per_gpu: 2
      dataset_enlarge_ratio: 1
      prefetch_mode: None
      phase: train
      scale: 1
    ]
    val:[
      name: RestoreNet-test
      type: PairedImageDataset
      dataroot_gt: D:\Premodel\RestoreNet\test\output
      dataroot_lq: D:\Premodel\RestoreNet\test\input
      io_backend:[
        type: disk
      ]
      phase: val
      scale: 1
    ]
  ]
  network_g:[
    type: RestoreNetLocal
    width_deblur: 64
    enc_blk_nums_deblur: [1, 1, 1, 28]
    middle_blk_num_deblur: 1
    dec_blk_nums_deblur: [1, 1, 1, 1]
    dw_expand_deblur: 2
    ffn_expand_deblur: 2
    width_denoise: 64
    enc_blk_nums_denoise: [2, 2, 4, 8]
    middle_blk_num_denoise: 12
    dec_blk_nums_denoise: [2, 2, 2, 2]
    dw_expand_denoise: 2
    ffn_expand_denoise: 2
  ]
  path:[
    pretrain_network_g: None
    strict_load_g: True
    resume_state: experiments/RestoreNet-width64/training_states/100000.state
    root: d:\premodel\restorenet
    experiments_root: d:\premodel\restorenet\experiments\RestoreNet-width64
    models: d:\premodel\restorenet\experiments\RestoreNet-width64\models
    training_states: d:\premodel\restorenet\experiments\RestoreNet-width64\training_states
    log: d:\premodel\restorenet\experiments\RestoreNet-width64
    visualization: d:\premodel\restorenet\experiments\RestoreNet-width64\visualization
  ]
  train:[
    optim_g:[
      type: AdamW
      lr: 0.001
      weight_decay: 0.001
      betas: [0.9, 0.9]
    ]
    scheduler:[
      type: TrueCosineAnnealingLR
      T_max: 400000
      eta_min: 1e-07
    ]
    total_iter: 400000
    warmup_iter: -1
    pixel_opt:[
      type: PSNRLoss
      loss_weight: 1
      reduction: mean
    ]
  ]
  val:[
    val_freq: 5000.0
    save_img: False
    metrics:[
      psnr:[
        type: calculate_psnr
        crop_border: 0
        test_y_channel: False
      ]
      ssim:[
        type: calculate_ssim
        crop_border: 0
        test_y_channel: False
      ]
    ]
  ]
  logger:[
    print_freq: 200
    save_checkpoint_freq: 5000.0
    use_tb_logger: True
    wandb:[
      project: None
      resume_id: None
    ]
  ]
  dist_params:[
    backend: gloo
    port: 4321
  ]
  is_train: True
  dist: False
  rank: 0
  world_size: 1

2023-06-08 16:03:39,560 INFO: Dataset PairedImageDataset - RestoreNet-train is created.
2023-06-08 16:03:39,561 INFO: Training statistics:
	Number of train images: 19978
	Dataset enlarge ratio: 1
	Batch size per gpu: 2
	World size (gpu number): 1
	Require iter number per epoch: 9989
	Total epochs: 41; iters: 400000.
2023-06-08 16:03:39,563 INFO: Dataset PairedImageDataset - RestoreNet-test is created.
2023-06-08 16:03:39,563 INFO: Number of val images/folders in RestoreNet-test: 21
2023-06-08 16:03:39,564 INFO: Set pretrain_network_g to d:\premodel\restorenet\experiments\RestoreNet-width64\models\net_g_100000.pth
2023-06-08 16:03:45,093 INFO: Loading RestoreNetLocal model from d:\premodel\restorenet\experiments\RestoreNet-width64\models\net_g_100000.pth.
2023-06-08 16:03:47,827 INFO: Model [ImageRestorationModel] is created.
2023-06-08 16:03:48,441 INFO: Resuming training from epoch: 8, iter: 100000.
2023-06-08 16:03:53,166 INFO: Start training from epoch: 8, iter: 100000
2023-06-08 16:05:19,934 INFO: [Resto..][epoch:  8, iter: 100,200, lr:(8.530e-04,)] [eta: 1 day, 13:54:24, time (data): 0.407 (0.000)] l_pix: -2.2182e+01 
2023-06-08 16:06:44,718 INFO: [Resto..][epoch:  8, iter: 100,400, lr:(8.525e-04,)] [eta: 1 day, 12:35:01, time (data): 0.485 (0.002)] l_pix: -2.1704e+01 
2023-06-08 16:08:11,002 INFO: [Resto..][epoch:  8, iter: 100,600, lr:(8.519e-04,)] [eta: 1 day, 12:19:59, time (data): 0.423 (0.001)] l_pix: -2.3249e+01 
2023-06-08 16:09:36,863 INFO: [Resto..][epoch:  8, iter: 100,800, lr:(8.513e-04,)] [eta: 1 day, 12:09:06, time (data): 0.425 (0.000)] l_pix: -2.1905e+01 
2023-06-08 16:11:02,487 INFO: [Resto..][epoch:  8, iter: 101,000, lr:(8.508e-04,)] [eta: 1 day, 12:00:49, time (data): 0.429 (0.000)] l_pix: -2.4004e+01 
2023-06-08 16:12:28,784 INFO: [Resto..][epoch:  8, iter: 101,200, lr:(8.502e-04,)] [eta: 1 day, 11:57:37, time (data): 0.410 (0.001)] l_pix: -2.2530e+01 
2023-06-08 16:13:54,431 INFO: [Resto..][epoch:  8, iter: 101,400, lr:(8.497e-04,)] [eta: 1 day, 11:52:36, time (data): 0.432 (0.001)] l_pix: -2.0527e+01 
2023-06-08 16:15:19,987 INFO: [Resto..][epoch:  8, iter: 101,600, lr:(8.491e-04,)] [eta: 1 day, 11:48:12, time (data): 0.424 (0.000)] l_pix: -2.0812e+01 
2023-06-08 16:16:46,340 INFO: [Resto..][epoch:  8, iter: 101,800, lr:(8.485e-04,)] [eta: 1 day, 11:46:39, time (data): 0.416 (0.000)] l_pix: -2.0212e+01 
2023-06-08 16:18:12,157 INFO: [Resto..][epoch:  8, iter: 102,000, lr:(8.480e-04,)] [eta: 1 day, 11:43:48, time (data): 0.425 (0.001)] l_pix: -2.5094e+01 
2023-06-08 16:19:37,090 INFO: [Resto..][epoch:  8, iter: 102,200, lr:(8.474e-04,)] [eta: 1 day, 11:39:13, time (data): 0.417 (0.001)] l_pix: -2.3386e+01 
2023-06-08 16:21:01,628 INFO: [Resto..][epoch:  8, iter: 102,400, lr:(8.468e-04,)] [eta: 1 day, 11:34:21, time (data): 0.416 (0.002)] l_pix: -2.3798e+01 
2023-06-08 16:22:26,417 INFO: [Resto..][epoch:  8, iter: 102,600, lr:(8.463e-04,)] [eta: 1 day, 11:30:29, time (data): 0.419 (0.001)] l_pix: -2.5040e+01 
2023-06-08 16:23:51,821 INFO: [Resto..][epoch:  8, iter: 102,800, lr:(8.457e-04,)] [eta: 1 day, 11:28:04, time (data): 0.414 (0.001)] l_pix: -2.3216e+01 
2023-06-08 16:25:17,243 INFO: [Resto..][epoch:  8, iter: 103,000, lr:(8.451e-04,)] [eta: 1 day, 11:25:48, time (data): 0.418 (0.001)] l_pix: -2.0871e+01 
2023-06-08 16:26:42,132 INFO: [Resto..][epoch:  8, iter: 103,200, lr:(8.446e-04,)] [eta: 1 day, 11:22:49, time (data): 0.418 (0.000)] l_pix: -2.1419e+01 
2023-06-08 16:28:07,221 INFO: [Resto..][epoch:  8, iter: 103,400, lr:(8.440e-04,)] [eta: 1 day, 11:20:19, time (data): 0.435 (0.002)] l_pix: -3.0282e+01 
2023-06-08 16:29:33,423 INFO: [Resto..][epoch:  8, iter: 103,600, lr:(8.434e-04,)] [eta: 1 day, 11:19:27, time (data): 0.416 (0.000)] l_pix: -2.2819e+01 
2023-06-08 16:30:56,963 INFO: [Resto..][epoch:  8, iter: 103,800, lr:(8.429e-04,)] [eta: 1 day, 11:15:05, time (data): 0.450 (0.000)] l_pix: -2.7263e+01 
2023-06-08 16:32:20,212 INFO: [Resto..][epoch:  8, iter: 104,000, lr:(8.423e-04,)] [eta: 1 day, 11:10:38, time (data): 0.419 (0.000)] l_pix: -2.4366e+01 
2023-06-08 16:33:45,442 INFO: [Resto..][epoch:  8, iter: 104,200, lr:(8.417e-04,)] [eta: 1 day, 11:08:49, time (data): 0.422 (0.001)] l_pix: -1.7292e+01 
2023-06-08 16:35:12,066 INFO: [Resto..][epoch:  8, iter: 104,400, lr:(8.411e-04,)] [eta: 1 day, 11:08:36, time (data): 0.419 (0.001)] l_pix: -1.7564e+01 
2023-06-08 16:36:38,025 INFO: [Resto..][epoch:  8, iter: 104,600, lr:(8.406e-04,)] [eta: 1 day, 11:07:33, time (data): 0.422 (0.001)] l_pix: -1.9754e+01 
2023-06-08 16:38:03,650 INFO: [Resto..][epoch:  8, iter: 104,800, lr:(8.400e-04,)] [eta: 1 day, 11:06:08, time (data): 0.419 (0.000)] l_pix: -1.9866e+01 
2023-06-08 16:39:29,090 INFO: [Resto..][epoch:  8, iter: 105,000, lr:(8.394e-04,)] [eta: 1 day, 11:04:32, time (data): 0.417 (0.001)] l_pix: -2.3694e+01 
2023-06-08 16:39:29,090 INFO: Saving models and training states.
2023-06-08 16:40:26,682 INFO: Validation RestoreNet-test, 		 # psnr: 24.5270	 # ssim: 0.8266
2023-06-08 16:40:26,683 INFO: [Resto..][epoch:  8, iter: 105,000, lr:(8.394e-04,)] m_psnr: 2.4527e+01 m_ssim: 8.2659e-01 
2023-06-08 16:41:52,981 INFO: [Resto..][epoch:  8, iter: 105,200, lr:(8.388e-04,)] [eta: 1 day, 11:58:10, time (data): 0.459 (0.001)] l_pix: -2.3190e+01 
2023-06-08 16:43:18,310 INFO: [Resto..][epoch:  8, iter: 105,400, lr:(8.383e-04,)] [eta: 1 day, 11:54:25, time (data): 0.439 (0.002)] l_pix: -2.0956e+01 
2023-06-08 16:44:43,389 INFO: [Resto..][epoch:  8, iter: 105,600, lr:(8.377e-04,)] [eta: 1 day, 11:50:36, time (data): 0.421 (0.000)] l_pix: -2.8349e+01 
2023-06-08 16:46:08,582 INFO: [Resto..][epoch:  8, iter: 105,800, lr:(8.371e-04,)] [eta: 1 day, 11:47:03, time (data): 0.418 (0.001)] l_pix: -2.3582e+01 
2023-06-08 16:47:33,383 INFO: [Resto..][epoch:  8, iter: 106,000, lr:(8.365e-04,)] [eta: 1 day, 11:43:20, time (data): 0.424 (0.001)] l_pix: -2.2675e+01 
2023-06-08 16:48:58,929 INFO: [Resto..][epoch:  8, iter: 106,200, lr:(8.359e-04,)] [eta: 1 day, 11:40:20, time (data): 0.417 (0.000)] l_pix: -2.3176e+01 
2023-06-08 16:50:24,216 INFO: [Resto..][epoch:  8, iter: 106,400, lr:(8.354e-04,)] [eta: 1 day, 11:37:15, time (data): 0.408 (0.000)] l_pix: -1.7375e+01 
2023-06-08 16:51:47,830 INFO: [Resto..][epoch:  8, iter: 106,600, lr:(8.348e-04,)] [eta: 1 day, 11:33:02, time (data): 0.408 (0.000)] l_pix: -2.0812e+01 
2023-06-08 16:53:11,195 INFO: [Resto..][epoch:  8, iter: 106,800, lr:(8.342e-04,)] [eta: 1 day, 11:28:47, time (data): 0.408 (0.000)] l_pix: -2.5579e+01 
2023-06-08 16:54:35,381 INFO: [Resto..][epoch:  8, iter: 107,000, lr:(8.336e-04,)] [eta: 1 day, 11:25:17, time (data): 0.408 (0.000)] l_pix: -2.3416e+01 
2023-06-08 16:55:59,976 INFO: [Resto..][epoch:  8, iter: 107,200, lr:(8.330e-04,)] [eta: 1 day, 11:22:10, time (data): 0.423 (0.000)] l_pix: -2.3621e+01 
2023-06-08 16:57:24,187 INFO: [Resto..][epoch:  8, iter: 107,400, lr:(8.324e-04,)] [eta: 1 day, 11:18:54, time (data): 0.408 (0.000)] l_pix: -1.9504e+01 
2023-06-08 16:58:46,857 INFO: [Resto..][epoch:  8, iter: 107,600, lr:(8.319e-04,)] [eta: 1 day, 11:14:45, time (data): 0.407 (0.000)] l_pix: -1.7743e+01 
2023-06-08 17:00:10,341 INFO: [Resto..][epoch:  8, iter: 107,800, lr:(8.313e-04,)] [eta: 1 day, 11:11:14, time (data): 0.423 (0.000)] l_pix: -2.3248e+01 
2023-06-08 17:01:35,201 INFO: [Resto..][epoch:  8, iter: 108,000, lr:(8.307e-04,)] [eta: 1 day, 11:08:40, time (data): 0.411 (0.000)] l_pix: -2.8992e+01 
2023-06-08 17:02:58,543 INFO: [Resto..][epoch:  8, iter: 108,200, lr:(8.301e-04,)] [eta: 1 day, 11:05:15, time (data): 0.407 (0.000)] l_pix: -2.1369e+01 
2023-06-08 17:04:22,111 INFO: [Resto..][epoch:  8, iter: 108,400, lr:(8.295e-04,)] [eta: 1 day, 11:02:04, time (data): 0.424 (0.000)] l_pix: -2.6609e+01 
2023-06-08 17:05:45,647 INFO: [Resto..][epoch:  8, iter: 108,600, lr:(8.289e-04,)] [eta: 1 day, 10:58:57, time (data): 0.407 (0.000)] l_pix: -1.9232e+01 
2023-06-08 17:07:09,593 INFO: [Resto..][epoch:  8, iter: 108,800, lr:(8.283e-04,)] [eta: 1 day, 10:56:08, time (data): 0.417 (0.001)] l_pix: -2.4134e+01 
2023-06-08 17:08:38,921 INFO: [Resto..][epoch:  8, iter: 109,000, lr:(8.277e-04,)] [eta: 1 day, 10:56:17, time (data): 0.461 (0.001)] l_pix: -2.0474e+01 
2023-06-08 17:10:08,286 INFO: [Resto..][epoch:  8, iter: 109,200, lr:(8.271e-04,)] [eta: 1 day, 10:56:23, time (data): 0.437 (0.001)] l_pix: -1.9433e+01 
2023-06-08 17:11:38,354 INFO: [Resto..][epoch:  8, iter: 109,400, lr:(8.265e-04,)] [eta: 1 day, 10:56:47, time (data): 0.438 (0.001)] l_pix: -1.9710e+01 
2023-06-08 17:13:05,856 INFO: [Resto..][epoch:  8, iter: 109,600, lr:(8.259e-04,)] [eta: 1 day, 10:55:48, time (data): 0.470 (0.001)] l_pix: -2.2734e+01 
2023-06-08 17:14:33,018 INFO: [Resto..][epoch:  8, iter: 109,800, lr:(8.253e-04,)] [eta: 1 day, 10:54:38, time (data): 0.433 (0.004)] l_pix: -2.7647e+01 
2023-06-08 17:15:59,149 INFO: [Resto..][epoch:  9, iter: 110,000, lr:(8.247e-04,)] [eta: 1 day, 10:52:57, time (data): 0.445 (0.000)] l_pix: -2.1389e+01 
2023-06-08 17:15:59,149 INFO: Saving models and training states.
2023-06-08 17:16:12,161 INFO: Validation RestoreNet-test, 		 # psnr: 24.4525	 # ssim: 0.8245
2023-06-08 17:16:12,163 INFO: [Resto..][epoch:  9, iter: 110,000, lr:(8.247e-04,)] m_psnr: 2.4452e+01 m_ssim: 8.2447e-01 
2023-06-08 17:17:38,526 INFO: [Resto..][epoch:  9, iter: 110,200, lr:(8.241e-04,)] [eta: 1 day, 10:57:33, time (data): 0.422 (0.000)] l_pix: -2.0250e+01 
2023-06-08 17:19:03,413 INFO: [Resto..][epoch:  9, iter: 110,400, lr:(8.235e-04,)] [eta: 1 day, 10:55:12, time (data): 0.406 (0.000)] l_pix: -2.0264e+01 
2023-06-08 17:20:30,587 INFO: [Resto..][epoch:  9, iter: 110,600, lr:(8.229e-04,)] [eta: 1 day, 10:53:54, time (data): 0.408 (0.001)] l_pix: -2.3289e+01 
2023-06-08 17:21:56,929 INFO: [Resto..][epoch:  9, iter: 110,800, lr:(8.223e-04,)] [eta: 1 day, 10:52:15, time (data): 0.423 (0.000)] l_pix: -2.2982e+01 
2023-06-08 17:23:20,501 INFO: [Resto..][epoch:  9, iter: 111,000, lr:(8.217e-04,)] [eta: 1 day, 10:49:23, time (data): 0.450 (0.000)] l_pix: -2.6498e+01 

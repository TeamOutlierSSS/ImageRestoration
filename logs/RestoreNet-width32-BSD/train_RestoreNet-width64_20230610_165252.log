2023-06-10 16:52:52,942 INFO: 
                ____                _       _____  ____
               / __ ) ____ _ _____ (_)_____/ ___/ / __ \
              / __  |/ __ `// ___// // ___/\__ \ / /_/ /
             / /_/ // /_/ /(__  )/ // /__ ___/ // _, _/
            /_____/ \__,_//____//_/ \___//____//_/ |_|
     ______                   __   __                 __      __
    / ____/____   ____   ____/ /  / /   __  __ _____ / /__   / /
   / / __ / __ \ / __ \ / __  /  / /   / / / // ___// //_/  / /
  / /_/ // /_/ // /_/ // /_/ /  / /___/ /_/ // /__ / /<    /_/
  \____/ \____/ \____/ \____/  /_____/\____/ \___//_/|_|  (_)
    
Version Information: 
	BasicSR: 1.2.0+50cb149
	PyTorch: 2.0.0
	TorchVision: 0.15.0
2023-06-10 16:52:52,957 INFO: 
  name: RestoreNet-width64
  model_type: ImageRestorationModel
  scale: 1
  num_gpu: 1
  manual_seed: 10
  datasets:[
    train:[
      name: RestoreNet-train
      type: PairedImageDataset
      dataroot_gt: D:\Premodel\RestoreNet\train\output
      dataroot_lq: D:\Premodel\RestoreNet\train\input
      filename_tmpl: {}
      io_backend:[
        type: disk
      ]
      gt_size: 256
      use_flip: True
      use_rot: True
      use_shuffle: True
      num_worker_per_gpu: 2
      batch_size_per_gpu: 2
      dataset_enlarge_ratio: 1
      prefetch_mode: None
      phase: train
      scale: 1
    ]
    val:[
      name: RestoreNet-test
      type: PairedImageDataset
      dataroot_gt: D:\Premodel\RestoreNet\test\output
      dataroot_lq: D:\Premodel\RestoreNet\test\input
      io_backend:[
        type: disk
      ]
      phase: val
      scale: 1
    ]
  ]
  network_g:[
    type: RestoreNetLocal
    width_deblur: 64
    enc_blk_nums_deblur: [1, 1, 1, 28]
    middle_blk_num_deblur: 1
    dec_blk_nums_deblur: [1, 1, 1, 1]
    dw_expand_deblur: 2
    ffn_expand_deblur: 2
    width_denoise: 64
    enc_blk_nums_denoise: [2, 2, 4, 8]
    middle_blk_num_denoise: 12
    dec_blk_nums_denoise: [2, 2, 2, 2]
    dw_expand_denoise: 2
    ffn_expand_denoise: 2
  ]
  path:[
    pretrain_network_g: None
    strict_load_g: True
    resume_state: experiments/RestoreNet-width64/training_states/200000.state
    root: d:\premodel\restorenet
    experiments_root: d:\premodel\restorenet\experiments\RestoreNet-width64
    models: d:\premodel\restorenet\experiments\RestoreNet-width64\models
    training_states: d:\premodel\restorenet\experiments\RestoreNet-width64\training_states
    log: d:\premodel\restorenet\experiments\RestoreNet-width64
    visualization: d:\premodel\restorenet\experiments\RestoreNet-width64\visualization
  ]
  train:[
    optim_g:[
      type: AdamW
      lr: 0.001
      weight_decay: 0.001
      betas: [0.9, 0.9]
    ]
    scheduler:[
      type: TrueCosineAnnealingLR
      T_max: 400000
      eta_min: 1e-07
    ]
    total_iter: 400000
    warmup_iter: -1
    pixel_opt:[
      type: PSNRLoss
      loss_weight: 1
      reduction: mean
    ]
  ]
  val:[
    val_freq: 5000.0
    save_img: False
    metrics:[
      psnr:[
        type: calculate_psnr
        crop_border: 0
        test_y_channel: False
      ]
      ssim:[
        type: calculate_ssim
        crop_border: 0
        test_y_channel: False
      ]
    ]
  ]
  logger:[
    print_freq: 200
    save_checkpoint_freq: 5000.0
    use_tb_logger: True
    wandb:[
      project: None
      resume_id: None
    ]
  ]
  dist_params:[
    backend: gloo
    port: 4321
  ]
  is_train: True
  dist: False
  rank: 0
  world_size: 1

2023-06-10 16:53:00,683 INFO: Dataset PairedImageDataset - RestoreNet-train is created.
2023-06-10 16:53:00,683 INFO: Training statistics:
	Number of train images: 19978
	Dataset enlarge ratio: 1
	Batch size per gpu: 2
	World size (gpu number): 1
	Require iter number per epoch: 9989
	Total epochs: 41; iters: 400000.
2023-06-10 16:53:00,683 INFO: Dataset PairedImageDataset - RestoreNet-test is created.
2023-06-10 16:53:00,683 INFO: Number of val images/folders in RestoreNet-test: 21
2023-06-10 16:53:00,683 INFO: Set pretrain_network_g to d:\premodel\restorenet\experiments\RestoreNet-width64\models\net_g_200000.pth
2023-06-10 16:53:06,138 INFO: Loading RestoreNetLocal model from d:\premodel\restorenet\experiments\RestoreNet-width64\models\net_g_200000.pth.
2023-06-10 16:53:08,352 INFO: Model [ImageRestorationModel] is created.
2023-06-10 16:53:09,867 INFO: Resuming training from epoch: 17, iter: 200000.
2023-06-10 16:53:14,142 INFO: Start training from epoch: 17, iter: 200000
2023-06-10 16:54:41,966 INFO: [Resto..][epoch: 17, iter: 200,200, lr:(4.993e-04,)] [eta: 1 day, 1:25:48, time (data): 0.400 (0.000)] l_pix: -2.0829e+01 
2023-06-10 16:56:04,195 INFO: [Resto..][epoch: 17, iter: 200,400, lr:(4.985e-04,)] [eta: 1 day, 0:06:12, time (data): 0.395 (0.000)] l_pix: -1.9992e+01 
2023-06-10 16:57:26,773 INFO: [Resto..][epoch: 17, iter: 200,600, lr:(4.977e-04,)] [eta: 23:40:35, time (data): 0.408 (0.000)] l_pix: -2.1412e+01 
2023-06-10 16:58:49,186 INFO: [Resto..][epoch: 17, iter: 200,800, lr:(4.969e-04,)] [eta: 23:26:24, time (data): 0.399 (0.010)] l_pix: -2.3890e+01 
2023-06-10 17:00:12,436 INFO: [Resto..][epoch: 17, iter: 201,000, lr:(4.961e-04,)] [eta: 23:20:06, time (data): 0.401 (0.000)] l_pix: -2.8178e+01 
2023-06-10 17:01:35,329 INFO: [Resto..][epoch: 17, iter: 201,200, lr:(4.953e-04,)] [eta: 23:14:28, time (data): 0.458 (0.000)] l_pix: -2.5741e+01 
2023-06-10 17:03:06,401 INFO: [Resto..][epoch: 17, iter: 201,400, lr:(4.946e-04,)] [eta: 23:29:21, time (data): 0.407 (0.000)] l_pix: -2.6146e+01 
2023-06-10 17:04:30,084 INFO: [Resto..][epoch: 17, iter: 201,600, lr:(4.938e-04,)] [eta: 23:24:53, time (data): 0.407 (0.000)] l_pix: -2.5206e+01 
2023-06-10 17:05:56,098 INFO: [Resto..][epoch: 17, iter: 201,800, lr:(4.930e-04,)] [eta: 23:25:23, time (data): 0.442 (0.000)] l_pix: -1.6728e+01 
2023-06-10 17:08:50,391 INFO: [Resto..][epoch: 17, iter: 202,000, lr:(4.922e-04,)] [eta: 1 day, 1:51:04, time (data): 0.400 (0.000)] l_pix: -2.1384e+01 
2023-06-10 17:10:13,852 INFO: [Resto..][epoch: 17, iter: 202,200, lr:(4.914e-04,)] [eta: 1 day, 1:33:43, time (data): 0.460 (0.000)] l_pix: -2.2897e+01 
2023-06-10 17:11:38,153 INFO: [Resto..][epoch: 17, iter: 202,400, lr:(4.906e-04,)] [eta: 1 day, 1:20:10, time (data): 0.413 (0.000)] l_pix: -2.4470e+01 
2023-06-10 17:13:01,158 INFO: [Resto..][epoch: 17, iter: 202,600, lr:(4.898e-04,)] [eta: 1 day, 1:06:51, time (data): 0.401 (0.010)] l_pix: -2.7219e+01 
2023-06-10 17:14:24,018 INFO: [Resto..][epoch: 17, iter: 202,800, lr:(4.891e-04,)] [eta: 1 day, 0:55:04, time (data): 0.431 (0.000)] l_pix: -2.1987e+01 
2023-06-10 17:15:46,840 INFO: [Resto..][epoch: 17, iter: 203,000, lr:(4.883e-04,)] [eta: 1 day, 0:44:37, time (data): 0.451 (0.000)] l_pix: -2.0053e+01 
2023-06-10 17:17:10,323 INFO: [Resto..][epoch: 17, iter: 203,200, lr:(4.875e-04,)] [eta: 1 day, 0:35:59, time (data): 0.431 (0.000)] l_pix: -2.5132e+01 
2023-06-10 17:18:32,938 INFO: [Resto..][epoch: 17, iter: 203,400, lr:(4.867e-04,)] [eta: 1 day, 0:27:22, time (data): 0.390 (0.000)] l_pix: -2.3515e+01 
2023-06-10 17:19:55,477 INFO: [Resto..][epoch: 17, iter: 203,600, lr:(4.859e-04,)] [eta: 1 day, 0:19:30, time (data): 0.401 (0.000)] l_pix: -2.3952e+01 
2023-06-10 17:21:17,736 INFO: [Resto..][epoch: 17, iter: 203,800, lr:(4.851e-04,)] [eta: 1 day, 0:12:03, time (data): 0.450 (0.000)] l_pix: -2.2441e+01 
2023-06-10 17:22:40,415 INFO: [Resto..][epoch: 17, iter: 204,000, lr:(4.844e-04,)] [eta: 1 day, 0:05:34, time (data): 0.390 (0.000)] l_pix: -2.6270e+01 
2023-06-10 17:24:03,794 INFO: [Resto..][epoch: 17, iter: 204,200, lr:(4.836e-04,)] [eta: 1 day, 0:00:07, time (data): 0.394 (0.000)] l_pix: -2.0553e+01 
2023-06-10 17:25:26,470 INFO: [Resto..][epoch: 17, iter: 204,400, lr:(4.828e-04,)] [eta: 23:54:30, time (data): 0.391 (0.000)] l_pix: -2.0218e+01 
2023-06-10 17:26:49,025 INFO: [Resto..][epoch: 17, iter: 204,600, lr:(4.820e-04,)] [eta: 23:49:11, time (data): 0.391 (0.000)] l_pix: -2.5178e+01 
2023-06-10 17:28:11,830 INFO: [Resto..][epoch: 17, iter: 204,800, lr:(4.812e-04,)] [eta: 23:44:21, time (data): 0.391 (0.000)] l_pix: -2.2476e+01 
2023-06-10 17:29:33,992 INFO: [Resto..][epoch: 17, iter: 205,000, lr:(4.804e-04,)] [eta: 23:39:23, time (data): 0.392 (0.000)] l_pix: -2.1615e+01 
2023-06-10 17:29:33,992 INFO: Saving models and training states.
2023-06-10 17:30:27,604 INFO: Validation RestoreNet-test, 		 # psnr: 24.6336	 # ssim: 0.8314
2023-06-10 17:30:27,613 INFO: [Resto..][epoch: 17, iter: 205,000, lr:(4.804e-04,)] m_psnr: 2.4634e+01 m_ssim: 8.3137e-01 
2023-06-10 17:31:50,133 INFO: [Resto..][epoch: 17, iter: 205,200, lr:(4.796e-04,)] [eta: 1 day, 0:08:23, time (data): 0.431 (0.000)] l_pix: -1.6941e+01 
2023-06-10 17:33:13,757 INFO: [Resto..][epoch: 17, iter: 205,400, lr:(4.789e-04,)] [eta: 1 day, 0:03:32, time (data): 0.431 (0.000)] l_pix: -2.6511e+01 
2023-06-10 17:34:36,532 INFO: [Resto..][epoch: 17, iter: 205,600, lr:(4.781e-04,)] [eta: 23:58:26, time (data): 0.391 (0.000)] l_pix: -2.8006e+01 
2023-06-10 17:35:59,017 INFO: [Resto..][epoch: 17, iter: 205,800, lr:(4.773e-04,)] [eta: 23:53:26, time (data): 0.442 (0.000)] l_pix: -1.9614e+01 
2023-06-10 17:37:22,231 INFO: [Resto..][epoch: 17, iter: 206,000, lr:(4.765e-04,)] [eta: 23:49:05, time (data): 0.401 (0.000)] l_pix: -2.5237e+01 
2023-06-10 17:38:44,903 INFO: [Resto..][epoch: 17, iter: 206,200, lr:(4.757e-04,)] [eta: 23:44:37, time (data): 0.441 (0.000)] l_pix: -2.5086e+01 
2023-06-10 17:40:07,624 INFO: [Resto..][epoch: 17, iter: 206,400, lr:(4.749e-04,)] [eta: 23:40:23, time (data): 0.420 (0.000)] l_pix: -2.8726e+01 
2023-06-10 17:41:30,116 INFO: [Resto..][epoch: 17, iter: 206,600, lr:(4.741e-04,)] [eta: 23:36:12, time (data): 0.400 (0.000)] l_pix: -2.1780e+01 
2023-06-10 17:42:52,917 INFO: [Resto..][epoch: 17, iter: 206,800, lr:(4.734e-04,)] [eta: 23:32:20, time (data): 0.430 (0.000)] l_pix: -2.3326e+01 
2023-06-10 17:44:16,049 INFO: [Resto..][epoch: 17, iter: 207,000, lr:(4.726e-04,)] [eta: 23:28:46, time (data): 0.431 (0.000)] l_pix: -3.1089e+01 
2023-06-10 17:45:38,982 INFO: [Resto..][epoch: 17, iter: 207,200, lr:(4.718e-04,)] [eta: 23:25:14, time (data): 0.450 (0.010)] l_pix: -2.2731e+01 
2023-06-10 17:47:01,461 INFO: [Resto..][epoch: 17, iter: 207,400, lr:(4.710e-04,)] [eta: 23:21:36, time (data): 0.400 (0.000)] l_pix: -2.1930e+01 
2023-06-10 17:48:24,354 INFO: [Resto..][epoch: 17, iter: 207,600, lr:(4.702e-04,)] [eta: 23:18:17, time (data): 0.410 (0.000)] l_pix: -2.4275e+01 
2023-06-10 17:49:47,284 INFO: [Resto..][epoch: 17, iter: 207,800, lr:(4.694e-04,)] [eta: 23:15:04, time (data): 0.400 (0.000)] l_pix: -2.2422e+01 
2023-06-10 17:51:09,709 INFO: [Resto..][epoch: 17, iter: 208,000, lr:(4.687e-04,)] [eta: 23:11:45, time (data): 0.391 (0.000)] l_pix: -2.4933e+01 
2023-06-10 17:52:33,108 INFO: [Resto..][epoch: 17, iter: 208,200, lr:(4.679e-04,)] [eta: 23:08:54, time (data): 0.390 (0.000)] l_pix: -2.3253e+01 
2023-06-10 17:53:55,759 INFO: [Resto..][epoch: 17, iter: 208,400, lr:(4.671e-04,)] [eta: 23:05:50, time (data): 0.441 (0.000)] l_pix: -2.2821e+01 
2023-06-10 17:55:18,534 INFO: [Resto..][epoch: 17, iter: 208,600, lr:(4.663e-04,)] [eta: 23:02:54, time (data): 0.393 (0.000)] l_pix: -1.8173e+01 
2023-06-10 17:56:41,037 INFO: [Resto..][epoch: 17, iter: 208,800, lr:(4.655e-04,)] [eta: 22:59:56, time (data): 0.440 (0.000)] l_pix: -2.1724e+01 
2023-06-10 17:58:03,532 INFO: [Resto..][epoch: 17, iter: 209,000, lr:(4.647e-04,)] [eta: 22:57:02, time (data): 0.401 (0.000)] l_pix: -2.2762e+01 
2023-06-10 17:59:25,585 INFO: [Resto..][epoch: 17, iter: 209,200, lr:(4.640e-04,)] [eta: 22:54:03, time (data): 0.440 (0.000)] l_pix: -2.9700e+01 
2023-06-10 18:00:48,419 INFO: [Resto..][epoch: 17, iter: 209,400, lr:(4.632e-04,)] [eta: 22:51:24, time (data): 0.390 (0.000)] l_pix: -2.4982e+01 
2023-06-10 18:02:11,381 INFO: [Resto..][epoch: 17, iter: 209,600, lr:(4.624e-04,)] [eta: 22:48:51, time (data): 0.391 (0.000)] l_pix: -2.5626e+01 
2023-06-10 18:03:33,769 INFO: [Resto..][epoch: 17, iter: 209,800, lr:(4.616e-04,)] [eta: 22:46:09, time (data): 0.421 (0.000)] l_pix: -1.9633e+01 
2023-06-10 18:04:56,263 INFO: [Resto..][epoch: 18, iter: 210,000, lr:(4.608e-04,)] [eta: 22:43:32, time (data): 0.442 (0.000)] l_pix: -3.0227e+01 
2023-06-10 18:04:56,263 INFO: Saving models and training states.
2023-06-10 18:05:09,362 INFO: Validation RestoreNet-test, 		 # psnr: 24.7059	 # ssim: 0.8311
2023-06-10 18:05:09,368 INFO: [Resto..][epoch: 18, iter: 210,000, lr:(4.608e-04,)] m_psnr: 2.4706e+01 m_ssim: 8.3113e-01 
2023-06-10 18:06:32,380 INFO: [Resto..][epoch: 18, iter: 210,200, lr:(4.600e-04,)] [eta: 22:45:12, time (data): 0.411 (0.000)] l_pix: -2.8335e+01 
2023-06-10 18:07:55,396 INFO: [Resto..][epoch: 18, iter: 210,400, lr:(4.593e-04,)] [eta: 22:42:46, time (data): 0.421 (0.000)] l_pix: -2.3148e+01 
2023-06-10 18:09:18,560 INFO: [Resto..][epoch: 18, iter: 210,600, lr:(4.585e-04,)] [eta: 22:40:24, time (data): 0.441 (0.000)] l_pix: -2.3378e+01 
2023-06-10 18:10:41,366 INFO: [Resto..][epoch: 18, iter: 210,800, lr:(4.577e-04,)] [eta: 22:37:59, time (data): 0.390 (0.000)] l_pix: -1.9832e+01 
2023-06-10 18:12:04,446 INFO: [Resto..][epoch: 18, iter: 211,000, lr:(4.569e-04,)] [eta: 22:35:40, time (data): 0.391 (0.000)] l_pix: -2.9961e+01 
2023-06-10 18:13:27,106 INFO: [Resto..][epoch: 18, iter: 211,200, lr:(4.561e-04,)] [eta: 22:33:17, time (data): 0.438 (0.000)] l_pix: -2.2372e+01 
2023-06-10 18:14:50,082 INFO: [Resto..][epoch: 18, iter: 211,400, lr:(4.554e-04,)] [eta: 22:31:00, time (data): 0.390 (0.000)] l_pix: -2.6189e+01 
2023-06-10 18:16:13,428 INFO: [Resto..][epoch: 18, iter: 211,600, lr:(4.546e-04,)] [eta: 22:28:52, time (data): 0.430 (0.000)] l_pix: -2.8422e+01 
2023-06-10 18:17:36,486 INFO: [Resto..][epoch: 18, iter: 211,800, lr:(4.538e-04,)] [eta: 22:26:40, time (data): 0.391 (0.000)] l_pix: -2.4388e+01 
2023-06-10 18:18:59,773 INFO: [Resto..][epoch: 18, iter: 212,000, lr:(4.530e-04,)] [eta: 22:24:34, time (data): 0.421 (0.000)] l_pix: -2.6382e+01 
2023-06-10 18:20:22,512 INFO: [Resto..][epoch: 18, iter: 212,200, lr:(4.522e-04,)] [eta: 22:22:21, time (data): 0.402 (0.000)] l_pix: -2.2857e+01 
2023-06-10 18:21:45,898 INFO: [Resto..][epoch: 18, iter: 212,400, lr:(4.514e-04,)] [eta: 22:20:19, time (data): 0.401 (0.000)] l_pix: -2.6516e+01 
2023-06-10 18:23:08,880 INFO: [Resto..][epoch: 18, iter: 212,600, lr:(4.507e-04,)] [eta: 22:18:12, time (data): 0.423 (0.000)] l_pix: -2.3699e+01 
2023-06-10 18:24:31,801 INFO: [Resto..][epoch: 18, iter: 212,800, lr:(4.499e-04,)] [eta: 22:16:06, time (data): 0.391 (0.000)] l_pix: -2.2442e+01 
2023-06-10 18:25:54,280 INFO: [Resto..][epoch: 18, iter: 213,000, lr:(4.491e-04,)] [eta: 22:13:55, time (data): 0.400 (0.000)] l_pix: -2.6676e+01 
